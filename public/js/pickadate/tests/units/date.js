var $DOM=$("#qunit-fixture"),$INPUT=$("<input type=password>");module("Date picker setup",{setup:function(){$DOM.append($INPUT.clone());var e=$DOM.find("input").pickadate();this.picker=e.pickadate("picker")},teardown:function(){this.picker.stop(),$DOM.empty()}}),test("Calendar stage",function(){strictEqual(this.picker.$root.find("."+$.fn.pickadate.defaults.klass.table+" [data-pick]").length,42,"42 selectables dates")}),test("Properties",function(){var e=this.picker,t=new Date;t.setHours(0,0,0,0),strictEqual(e.get("min").pick,-1/0,"Default “min” is -Infinity"),strictEqual(e.get("max").pick,1/0,"Default “max’ is +Infinity"),strictEqual(e.get("now").pick,t.getTime(),"Default “now” is "+e.get("now","yyyy/mm/dd")),deepEqual(e.get("select"),null,"Default “select” is `null`"),deepEqual(e.get("highlight"),e.get("now"),"Default “highlight” is “now”"),strictEqual(e.get("view").pick,t.setDate(1),"Default “view” is "+e.get("view","yyyy/mm/dd"))}),test("First weekday",function(){var e=this.picker,t=e.$node;strictEqual(e.$root.find("."+$.fn.pickadate.defaults.klass.weekdays).first().text(),$.fn.pickadate.defaults.weekdaysShort[0],"Sunday is first day"),e.stop().$node.pickadate({firstDay:1}),strictEqual(t.pickadate("picker").$root.find("."+$.fn.pickadate.defaults.klass.weekdays).first().text(),$.fn.pickadate.defaults.weekdaysShort[1],"Monday is first day"),e.set("select",[2013,8,14]),strictEqual(e.$root.find("td").first().text(),"1","Months starting on Sunday shift back a week")}),test("Formats",function(){var e=this.picker,t=new Date,a=function(e){return(e<10?"0":"")+e},i={d:function(){return""+t.getDate()},dd:function(){return a(t.getDate())},ddd:function(){return $.fn.pickadate.defaults.weekdaysShort[t.getDay()]},dddd:function(){return $.fn.pickadate.defaults.weekdaysFull[t.getDay()]},m:function(){return""+(t.getMonth()+1)},mm:function(){return a(t.getMonth()+1)},mmm:function(){return $.fn.pickadate.defaults.monthsShort[t.getMonth()]},mmmm:function(){return $.fn.pickadate.defaults.monthsFull[t.getMonth()]},yy:function(){return(""+t.getFullYear()).slice(2)},yyyy:function(){return""+t.getFullYear()}};t.setHours(0,0,0,0),["d","dd","ddd","dddd","m","mm","mmm","mmmm","yy","yyyy"].forEach(function(t){var a=i[t]();deepEqual(e.get("now",t),a,"`"+t+"`: "+a)})}),module("Date picker setup",{teardown:function(){$DOM.empty()}}),test("Editable",function(){$DOM.append($INPUT.clone()).append($INPUT.clone());var e=$DOM.find("input").eq(0).pickadate(),t=$DOM.find("input").eq(1).pickadate({editable:!0});strictEqual(e[0].readOnly,!0,"Editable: false"),strictEqual(t[0].readOnly,!1,"Editable: true")}),test("Disable today with `min` as `true`",function(){$DOM.append($INPUT.clone());var e=new Date,t=$DOM.find("input").pickadate({min:!0,disable:[e]}).pickadate("picker").get("highlight");deepEqual([e.getFullYear(),e.getMonth(),e.getDate()+1],[t.year,t.month,t.date],"Able to disable today")}),test("Disable today with `max` as `true`",function(){$DOM.append($INPUT.clone());var e=new Date,t=$DOM.find("input").pickadate({max:!0,disable:[e]}).pickadate("picker").get("highlight");deepEqual([e.getFullYear(),e.getMonth(),e.getDate()-1],[t.year,t.month,t.date],"Able to disable today")}),module("Date picker `set`",{setup:function(){$DOM.append($INPUT.clone());var e=$DOM.find("input").pickadate();this.picker=e.pickadate("picker")},teardown:function(){this.picker.stop(),$DOM.empty()}}),test("`clear`",function(){var e=this.picker;strictEqual(e.get("select"),null,"Starts off without a selection"),e.set("select",new Date),notStrictEqual(e.get("select"),null,"A selection has been added"),e.clear(),strictEqual(e.get("select"),null,"Clears out selection")}),test("`select`",function(){var e=this.picker,t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()+40);t.setHours(0,0,0,0),e.set("select",a.getTime()),deepEqual(e.get("select").obj,a,"`select` using a number: "+a),strictEqual(e.get("value"),e.get("select",$.fn.pickadate.defaults.format),"`value` matches"),deepEqual(e.get("highlight"),e.get("select"),"`highlight` updated"),strictEqual(e.get("view","yyyy/mm/dd"),e.get("highlight","yyyy/mm/01"),"`view` updated"),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected"),a.setDate(a.getDate()+40),e.set("select",[a.getFullYear(),a.getMonth(),a.getDate()]),deepEqual(e.get("select").obj,a,"`select` using an array: "+a),strictEqual(e.get("value"),e.get("select",$.fn.pickadate.defaults.format),"`value` matches"),deepEqual(e.get("highlight"),e.get("select"),"`highlight` updated"),strictEqual(e.get("view","yyyy/mm/dd"),e.get("highlight","yyyy/mm/01"),"`view` updated"),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected"),a.setDate(a.getDate()+40),e.set("select",a),deepEqual(e.get("select").obj,a,"`select` using a JS date object: "+a),strictEqual(e.get("value"),e.get("select",$.fn.pickadate.defaults.format),"`value` matches"),deepEqual(e.get("highlight"),e.get("select"),"`highlight` updated"),strictEqual(e.get("view","yyyy/mm/dd"),e.get("highlight","yyyy/mm/01"),"`view` updated"),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected")}),test("`highlight`",function(){var e=this.picker,t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()+40);t.setHours(0,0,0,0),e.set("highlight",a.getTime()),deepEqual(e.get("highlight").obj,a,"`highlight` using a number: "+a),strictEqual(e.get("view","yyyy/mm/dd"),e.get("highlight","yyyy/mm/01"),"`view` updated: "+e.get("view","yyyy/mm/dd")),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected"),a.setDate(a.getDate()+40),e.set("highlight",[a.getFullYear(),a.getMonth(),a.getDate()]),deepEqual(e.get("highlight").obj,a,"`highlight` using an array: "+a),strictEqual(e.get("view","yyyy/mm/dd"),e.get("highlight","yyyy/mm/01"),"`view` updated: "+e.get("view","yyyy/mm/dd")),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected"),a.setDate(a.getDate()+40),e.set("highlight",a),deepEqual(e.get("highlight").obj,a,"`highlight` using a JS date object: "+a),strictEqual(e.get("view","yyyy/mm/dd"),e.get("highlight","yyyy/mm/01"),"`view` updated: "+e.get("view","yyyy/mm/dd")),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected")}),test("`view`",function(){var e=this.picker,t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()+40);t.setHours(0,0,0,0),e.set("view",a.getTime()),a.setDate(1),deepEqual(e.get("view").obj,a,"`view` using a number: "+a),deepEqual(e.get("highlight").obj,t,"`highlight` unaffected"),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected"),a.setDate(a.getDate()+40),e.set("view",[a.getFullYear(),a.getMonth(),a.getDate()]),a.setDate(1),deepEqual(e.get("view").obj,a,"`view` using a number: "+a),deepEqual(e.get("highlight").obj,t,"`highlight` unaffected"),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected"),a.setDate(a.getDate()+40),e.set("view",a),a.setDate(1),deepEqual(e.get("view").obj,a,"`view` using a JS date object: "+a),deepEqual(e.get("highlight").obj,t,"`highlight` unaffected"),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected")}),test("`min`",function(){var e=this.picker,t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()-40);t.setHours(0,0,0,0),e.set("min",-40),deepEqual(e.get("min").obj,a,"`min` using a negative number: "+a),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),deepEqual(e.get("highlight"),e.get("now"),"`highlight` unaffected"),a.setDate(1),a.setMonth(t.getMonth()),a.setFullYear(t.getFullYear()),deepEqual(e.get("view").obj,a,"`view` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected"),e.set("min",40),a.setDate(t.getDate()+40),deepEqual(e.get("min").obj,a,"`min` using a positive number: "+a),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),deepEqual(e.get("highlight"),e.get("min"),"`highlight` updated"),a.setDate(1),deepEqual(e.get("view").obj,a,"`view` updated"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected"),a.setDate(a.getDate()+40),e.set("min",[a.getFullYear(),a.getMonth(),a.getDate()]),deepEqual(e.get("min").obj,a,"`min` using an array: "+a),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),deepEqual(e.get("highlight"),e.get("min"),"`highlight` updated"),strictEqual(e.get("value"),"","`value` unaffected"),a.setDate(1),deepEqual(e.get("view").obj,a,"`view` updated"),deepEqual(e.get("max").pick,1/0,"`max` unaffected"),a.setDate(a.getDate()+40),e.set("min",a),deepEqual(e.get("min").obj,a,"`min` using a JS date object: "+a),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),deepEqual(e.get("highlight"),e.get("min"),"`highlight` updated"),strictEqual(e.get("value"),"","`value` unaffected"),a.setDate(1),deepEqual(e.get("view").obj,a,"`view` updated"),deepEqual(e.get("max").pick,1/0,"`max` unaffected")}),test("`min` using booleans",function(){var e=this.picker,t=new Date,a=new Date(t.getFullYear(),t.getMonth(),1);t.setHours(0,0,0,0),e.set("min",!0),deepEqual(e.get("min").obj,t,"`min` using `true`: "+t),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),deepEqual(e.get("highlight"),e.get("now"),"`highlight` unaffected"),deepEqual(e.get("view").obj,a,"`view` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected"),e.set("min",!1),deepEqual(e.get("min").obj,-1/0,"`min` using `false`: "+-1/0),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),deepEqual(e.get("highlight"),e.get("now"),"`highlight` unaffected"),deepEqual(e.get("view").obj,a,"`view` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("max").pick,1/0,"`max` unaffected")}),test("`min` using strings",function(){var e=this.picker,t=e.get("min");strictEqual(t.pick,-1/0,"No `min` date"),e.set("min","8 January, 2013"),t=e.get("min"),deepEqual([t.year,t.month,t.date],[2013,0,8],"`min` updated")}),test("`max`",function(){var e=this.picker,t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()+40);t.setHours(0,0,0,0),e.set("max",40),deepEqual(e.get("max").obj,a,"`max` using a positive number: "+a),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),deepEqual(e.get("highlight"),e.get("now"),"`highlight` unaffected"),a.setYear(t.getFullYear()),a.setMonth(t.getMonth()),a.setDate(1),deepEqual(e.get("view").obj,a,"`view` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),e.set("max",-40),a.setDate(t.getDate()-40),deepEqual(e.get("max").obj,a,"`max` using a negative number: "+a),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),deepEqual(e.get("highlight"),e.get("max"),"`highlight` updated"),a.setDate(1),deepEqual(e.get("view").obj,a,"`view` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),a.setDate(a.getDate()-40),e.set("max",[a.getFullYear(),a.getMonth(),a.getDate()]),deepEqual(e.get("max").obj,a,"`max` using an array: "+a),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),deepEqual(e.get("highlight"),e.get("max"),"`highlight` updated"),strictEqual(e.get("value"),"","`value` unaffected"),a.setDate(1),deepEqual(e.get("view").obj,a,"`view` updated"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),a.setDate(a.getDate()-40),e.set("max",a),deepEqual(e.get("max").obj,a,"`max` using a JS date object: "+a),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),deepEqual(e.get("highlight"),e.get("max"),"`highlight` updated"),strictEqual(e.get("value"),"","`value` unaffected"),a.setDate(1),deepEqual(e.get("view").obj,a,"`view` updated"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected")}),test("`max` using booleans",function(){var e=this.picker,t=new Date,a=new Date(t.getFullYear(),t.getMonth(),1);t.setHours(0,0,0,0),e.set("max",!0),deepEqual(e.get("max").obj,t,"`max` using `true`: "+t),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),deepEqual(e.get("highlight"),e.get("now"),"`highlight` unaffected"),deepEqual(e.get("view").obj,a,"`view` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected"),e.set("max",!1),deepEqual(e.get("max").obj,1/0,"`max` using `false`: "+1/0),deepEqual(e.get("now").obj,t,"`now` unaffected"),deepEqual(e.get("select"),null,"`select` unaffected"),deepEqual(e.get("highlight"),e.get("now"),"`highlight` unaffected"),deepEqual(e.get("view").obj,a,"`view` unaffected"),strictEqual(e.get("value"),"","`value` unaffected"),deepEqual(e.get("min").pick,-1/0,"`min` unaffected")}),test("`max` using strings",function(){var e=this.picker,t=e.get("max");strictEqual(t.pick,1/0,"No `max` date"),e.set("max","8 January, 2013"),t=e.get("max"),deepEqual([t.year,t.month,t.date],[2013,0,8],"`max` updated")}),test("`disable` and `enable` using integers",function(){var e=new Date,t=[1,4,7],a=this.picker,i=a.$root;e.setHours(0,0,0,0),a.set("disable",t),t.indexOf(e.getDay()+1)>-1&&notDeepEqual(a.get("highlight"),a.get("now"),"Shifted disabled `highlight`: "+a.get("highlight").obj),deepEqual(a.get("disable"),t,"Disabled dates added to collection"),i.find("tr").each(function(e,a){$(a).find("[data-pick]").each(function(e,a){t.indexOf(e+1)>-1?ok($(a).hasClass($.fn.pickadate.defaults.klass.disabled),"Disabled as day of week: "+(e+1)+". Date: "+a.innerHTML):ok(!$(a).hasClass($.fn.pickadate.defaults.klass.disabled),"Enabled as day of week: "+(e+1)+". Date: "+a.innerHTML)})}),a.set("enable",[1]),deepEqual(a.get("disable"),[4,7],"Disabled date removed from collection"),i.find("tr").each(function(e,t){$(t).find("[data-pick]").each(function(e,t){[4,7].indexOf(e+1)>-1?ok($(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Disabled as day of week: "+(e+1)+". Date: "+t.innerHTML):ok(!$(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Enabled as day of week: "+(e+1)+". Date: "+t.innerHTML)})}),a.set("enable","flip"),deepEqual(a.get("disable"),[4,7],"Disabled collection `enable` flipped"),strictEqual(a.get("enable"),-1,"Inverted `enable`"),i.find("tr").each(function(e,t){$(t).find("[data-pick]").each(function(e,t){[4,7].indexOf(e+1)<0?ok($(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Disabled as day of week: "+(e+1)+". Date: "+t.innerHTML):ok(!$(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Enabled as day of week: "+(e+1)+". Date: "+t.innerHTML)})}),a.set("disable","flip"),deepEqual(a.get("disable"),[4,7],"Disabled collection `disable` flipped"),strictEqual(a.get("enable"),1,"Inverted back `enable`"),i.find("tr").each(function(e,t){$(t).find("[data-pick]").each(function(e,t){[4,7].indexOf(e+1)>-1?ok($(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Disabled as day of week: "+(e+1)+". Date: "+t.innerHTML):ok(!$(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Enabled as day of week: "+(e+1)+". Date: "+t.innerHTML)})})}),test("`disable` and `enable` using arrays",function(){var e=new Date,t=e.getFullYear(),a=e.getMonth(),i=[[t,a,1],[t,a,25],[t,a,17]],d=this.picker,l=d.get("view").day,n=d.$root;d.set("disable",i),deepEqual(d.get("disable"),i,"Disabled dates added to collection"),n.find("td [data-pick]").each(function(e,t){var a=e-l+1;1===a||17===a||25===a?ok($(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is disabled: "+t.innerHTML):ok(!$(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is enabled: "+t.innerHTML)}),d.set("enable",[[t,a,17]]),i=[[t,a,1],[t,a,25]],deepEqual(d.get("disable"),i,"Disabled date removed from collection"),n.find("td [data-pick]").each(function(e,t){var a=e-l+1;1===a||25===a?ok($(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is disabled: "+t.innerHTML):ok(!$(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is enabled: "+t.innerHTML)}),d.set("enable","flip"),deepEqual(d.get("disable"),i,"Disabled collection `enable` flipped"),deepEqual(d.get("enable"),-1,"Base state disabled"),n.find("td [data-pick]").each(function(e,t){var a=e-l+1;1!==a&&25!==a?ok($(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is disabled: "+t.innerHTML):ok(!$(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is enabled: "+t.innerHTML)}),d.set("disable","flip"),deepEqual(d.get("disable"),i,"Disabled collection `disable` flipped"),deepEqual(d.get("enable"),1,"Base state enabled"),n.find("td [data-pick]").each(function(e,t){var a=e-l+1;1===a||25===a?ok($(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is disabled: "+t.innerHTML):ok(!$(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is enabled: "+t.innerHTML)})}),test("`disable` and `enable` using JS dates",function(){var e=new Date,t=e.getFullYear(),a=e.getMonth(),i=[new Date(t,a,1),new Date(t,a,17),new Date(t,a,25)],d=this.picker,l=d.get("view").day,n=d.$root;d.set("disable",i),deepEqual(d.get("disable"),i,"Disabled dates added to collection"),n.find("td [data-pick]").each(function(e,t){var a=e-l+1;1===a||17===a||25===a?ok($(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is disabled: "+t.innerHTML):ok(!$(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is enabled: "+t.innerHTML)}),d.set("enable",[new Date(t,a,17)]),deepEqual(d.get("disable"),[new Date(t,a,1),new Date(t,a,25)],"Disabled date removed from collection"),n.find("td [data-pick]").each(function(e,t){var a=e-l+1;1===a||25===a?ok($(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is disabled: "+t.innerHTML):ok(!$(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is enabled: "+t.innerHTML)}),d.set("enable","flip"),deepEqual(d.get("disable"),[new Date(t,a,1),new Date(t,a,25)],"Disabled collection `enable` flipped"),n.find("td [data-pick]").each(function(e,t){var a=e-l+1;1!==a&&25!==a?ok($(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is disabled: "+t.innerHTML):ok(!$(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is enabled: "+t.innerHTML)}),d.set("disable","flip"),deepEqual(d.get("disable"),[new Date(t,a,1),new Date(t,a,25)],"Disabled collection `disable` flipped"),n.find("td [data-pick]").each(function(e,t){var a=e-l+1;1===a||25===a?ok($(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is disabled: "+t.innerHTML):ok(!$(t).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is enabled: "+t.innerHTML)})}),test("`disable` and `enable` using booleans",function(){var e=new Date,t=e.getFullYear(),a=e.getMonth(),i=[[t,a,1],[t,a,17],[t,a,25]],d=this.picker,l=d.$root;d.set("disable",i),deepEqual(d.get("disable"),i,"Disabled dates added to collection"),d.set("disable",!1),deepEqual(d.get("disable"),[],"Disabled collection reset"),strictEqual(l.find("."+$.fn.pickadate.defaults.klass.disabled).length,0,"No dates disabled"),d.set("disable",i),deepEqual(d.get("disable"),i,"Disabled dates added to collection"),d.set("disable",!0),deepEqual(d.get("disable"),[],"Disabled collection reset"),deepEqual(d.get("enable"),-1,"Disabled collection `enable` flipped"),strictEqual(l.find("."+$.fn.pickadate.defaults.klass.disabled).length,42,"All dates disabled"),d.set("enable","flip"),deepEqual(d.get("enable"),1,"Disabled collection `enable` flipped"),d.set("disable",i),deepEqual(d.get("disable"),i,"Disabled dates added to collection"),d.set("enable",!0),deepEqual(d.get("disable"),[],"Disabled collection reset"),strictEqual(l.find("."+$.fn.pickadate.defaults.klass.disabled).length,0,"No dates disabled"),d.set("disable",i),deepEqual(d.get("disable"),i,"Disabled dates added to collection"),d.set("enable",!1),deepEqual(d.get("disable"),[],"Disabled collection reset"),deepEqual(d.get("enable"),-1,"Disabled collection `enable` flipped"),strictEqual(l.find("."+$.fn.pickadate.defaults.klass.disabled).length,42,"All dates disabled")}),test("`disable` and `enable` using ranges",function(){var e,t,a=this.picker,i=a.$root;a.set("view",[2014,2,1]),t=a.get("view").day+1,e=[{from:[2014,2,4],to:[2014,2,14]}],a.set("disable",e),deepEqual(a.get("disable"),e,"Disabled range"),i.find("td [data-pick]").each(function(e,a){var i=e-t;i>=2&&i<=12?ok($(a).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is disabled: "+a.innerHTML):ok(!$(a).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is enabled: "+a.innerHTML)}),a.set("enable",e),deepEqual(a.get("disable"),[],"Cleared disabled range"),strictEqual(i.find("."+$.fn.pickadate.defaults.klass.disabled).length,0,"No dates disabled"),e=[{from:new Date(2014,2,7),to:new Date(2014,2,17)}],a.set("disable",e),deepEqual(a.get("disable"),e,"Disabled range updated"),i.find("td [data-pick]").each(function(e,a){var i=e-t;i>=5&&i<=15?ok($(a).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is disabled: "+a.innerHTML):ok(!$(a).hasClass($.fn.pickadate.defaults.klass.disabled),"Date is enabled: "+a.innerHTML)}),a.set("enable",e),deepEqual(a.get("disable"),[],"Cleared disabled range"),strictEqual(i.find("."+$.fn.pickadate.defaults.klass.disabled).length,0,"No dates disabled")}),test("`disable` and `enable` using relative ranges",function(){var e,t,a,i,d,l=this.picker,n=l.$root,s=l.get("now").obj,u=s.getFullYear(),o=s.getMonth(),g=s.getDate(),c=[u,o,g-10];for(e=[{from:!0,to:new Date(u,o,g+10)}],l.set("disable",e),deepEqual(l.get("disable"),e,"Disabled range relative to today with date object"),a=n.find("."+$.fn.pickadate.defaults.klass.disabled),t=0,datesCount=a.length;t<datesCount;t+=1)i=+a[t].innerHTML,i=new Date(u,o,i),ok(i>=s&&i<=new Date(u,o,g+10),"Date is disabled: "+i);for(l.set("enable",e),deepEqual(l.get("disable"),[],"Cleared disabled range"),ok(!n.find("."+$.fn.pickadate.defaults.klass.disabled).length,"No dates disabled"),e=[{from:c,to:!0}],l.set("disable",e),deepEqual(l.get("disable"),e,"Disabled range relative to today with array"),a=n.find("."+$.fn.pickadate.defaults.klass.disabled),t=0,datesCount=a.length;t<datesCount;t+=1)d=(i=+a[t].innerHTML)>g?1:0,i=new Date(u,o-d,i),ok(i<=s&&i>=new Date(u,o,g-10),"Date is disabled: "+i);for(l.set("enable",e),deepEqual(l.get("disable"),[],"Cleared disabled range"),ok(!n.find("."+$.fn.pickadate.defaults.klass.disabled).length,"No dates disabled"),e=[{from:!0,to:10}],l.set("disable",e),deepEqual(l.get("disable"),e,"Disabled range relative to today with positive integer"),a=n.find("."+$.fn.pickadate.defaults.klass.disabled),t=0,datesCount=a.length;t<datesCount;t+=1)i=+a[t].innerHTML,i=new Date(u,o,i),ok(i>=s&&i<=new Date(u,o,g+10),"Date is disabled: "+i);for(l.set("enable",e),deepEqual(l.get("disable"),[],"Cleared disabled range"),ok(!n.find("."+$.fn.pickadate.defaults.klass.disabled).length,"No dates disabled"),e=[{from:-10,to:!0}],l.set("disable",e),deepEqual(l.get("disable"),e,"Disabled range relative to today with negative integer"),a=n.find("."+$.fn.pickadate.defaults.klass.disabled),t=0,datesCount=a.length;t<datesCount;t+=1)d=(i=+a[t].innerHTML)>g?1:0,i=new Date(u,o-d,i),ok(i<=s&&i>=new Date(u,o,g-10),"Date is disabled: "+i)}),test("`disable` and `enable` using overlapping ranges",function(){var e,t=this.picker,a=t.$root;for(t.set("view",[2014,2,1]),t.set("disable",[{from:[2014,2,4],to:[2014,2,28]}]),t.set("enable",[{from:[2014,2,14],to:[2014,2,18]}]),e=[{from:[2014,2,4],to:[2014,2,28]},{from:[2014,2,14],to:[2014,2,18],inverted:!0}],deepEqual(t.get("disable"),e,"Inverted range within disabled range"),$dates=a.find("."+$.fn.pickadate.defaults.klass.disabled),index=0,datesCount=$dates.length;index<datesCount;index+=1)disabledDate=+$dates[index].innerHTML,ok(disabledDate>=4&&disabledDate<14||disabledDate>18&&disabledDate<=28,"Date is disabled: "+disabledDate);for(t.set("disable",!1),t.set("disable",[{from:[2014,2,4],to:[2014,2,28]}]),t.set("enable",[{from:[2014,2,1],to:[2014,2,14]}]),e=[{from:[2014,2,4],to:[2014,2,28]},{from:[2014,2,1],to:[2014,2,14],inverted:!0}],deepEqual(t.get("disable"),e,"Inverted range before and within disabled range"),$dates=a.find("."+$.fn.pickadate.defaults.klass.disabled),index=0,datesCount=$dates.length;index<datesCount;index+=1)disabledDate=+$dates[index].innerHTML,ok(disabledDate>=14&&disabledDate<=28,"Date is disabled: "+disabledDate);for(t.set("disable",!1),t.set("disable",[{from:[2014,2,4],to:[2014,2,20]}]),t.set("enable",[{from:[2014,2,16],to:[2014,2,24]}]),e=[{from:[2014,2,4],to:[2014,2,20]},{from:[2014,2,16],to:[2014,2,24],inverted:!0}],deepEqual(t.get("disable"),e,"Inverted range after and within disabled range"),$dates=a.find("."+$.fn.pickadate.defaults.klass.disabled),index=0,datesCount=$dates.length;index<datesCount;index+=1)disabledDate=+$dates[index].innerHTML,ok(disabledDate>=4&&disabledDate<16,"Date is disabled: "+disabledDate)}),test("`disable` and `enable` repeatedly",function(){var e,t=new Date(2014,3,6),a=t.getFullYear(),i=t.getMonth(),d=t.getDate(),l=this.picker,n=[[a,i,1],[a,i,17],new Date(a,i,25),1,{from:[a,i,4],to:[a,i,10]},{from:[a,i,8],to:[a,i,12]}];l.set("disable",n),l.set("disable",n),deepEqual(l.get("disable"),n,"Collection without duplicates"),e=[[a,i,17],[a,i,25],t,{from:[a,i,8],to:[a,i,12]}],l.set("enable",e),n=[[a,i,1],1,{from:[a,i,4],to:[a,i,10]},[a,i,d,"inverted"],{from:[a,i,8],to:[a,i,12],inverted:!0}],deepEqual(l.get("disable"),n,"Collection enabled various values"),l.set("enable",e),deepEqual(l.get("disable"),n,"Collection without duplicates"),e=n,l.set("enable",e),deepEqual(l.get("disable"),[],"Collection cleared - including inverted range overlaps"),l.set("enable",e),deepEqual(l.get("disable"),[],"Collection kept clear")}),module("Date picker `set` beyond limits",{setup:function(){$DOM.append($INPUT.clone());var e=$DOM.find("input").pickadate({min:-40,max:40});this.picker=e.pickadate("picker")},teardown:function(){this.picker.stop(),$DOM.empty()}}),test("`select`",function(){var e=this.picker,t=new Date;t.setHours(0,0,0,0),e.set("select",new Date(t.getFullYear(),t.getMonth(),t.getDate()-60)),deepEqual(e.get("select"),e.get("min"),"Able to not `select` beyond lower limit"),e.set("select",new Date(t.getFullYear(),t.getMonth(),t.getDate()+60)),deepEqual(e.get("select"),e.get("max"),"Able to not `select` beyond upper limit")}),test("`highlight`",function(){var e=this.picker,t=new Date;t.setHours(0,0,0,0),e.set("highlight",new Date(t.getFullYear(),t.getMonth(),t.getDate()-60)),deepEqual(e.get("highlight"),e.get("min"),"Able to not `highlight` beyond lower limit"),e.set("highlight",new Date(t.getFullYear(),t.getMonth(),t.getDate()+60)),deepEqual(e.get("highlight"),e.get("max"),"Able to not `highlight` beyond upper limit")}),test("`view`",function(){var e,t=this.picker,a=new Date,i=t.get("min"),d=t.get("max");a.setHours(0,0,0,0),t.set("view",new Date(a.getFullYear(),a.getMonth(),a.getDate()-60)),e=t.get("view"),deepEqual([e.year,e.month,e.date],[i.year,i.month,1],"Able to not `view` beyond lower limit"),t.set("view",new Date(a.getFullYear(),a.getMonth(),a.getDate()+60)),e=t.get("view"),deepEqual([e.year,e.month,e.date],[d.year,d.month,1],"Able to not `view` beyond upper limit")}),module("Date picker mouse events",{setup:function(){$DOM.append($INPUT.clone());var e=$DOM.find("input").pickadate();this.picker=e.pickadate("picker")},teardown:function(){this.picker.stop(),$DOM.empty()}}),test("Select",function(){for(var e=this.picker,t=e.$root,a=e.get("view"),i=a.day,d=new Date(a.year,a.month+1,0).getDate(),l=i;l<i+d;l+=1)t.find("."+$.fn.pickadate.defaults.klass.day).eq(l).click(),strictEqual(e.get("select").pick,new Date(a.year,a.month,a.date+l-i).getTime(),"Selected "+e.get("select","yyyy/mm/dd")),strictEqual(e.get("value"),e.get("select",$.fn.pickadate.defaults.format),"Input value updated to "+e.get("value"))}),test("Highlight",function(){var e=this.picker,t=e.$root,a=new Date,i=new Date;for(a.setHours(0,0,0,0),i.setHours(0,0,0,0),t.find("."+$.fn.pickadate.defaults.klass.navPrev).click(),i.setMonth(i.getMonth()-1),deepEqual(e.get("highlight").obj,i,"Previous month: "+i),deepEqual(e.get("select"),null,"Select unaffected"),i.setDate(1),deepEqual(e.get("view").obj,i,"View updated"),t.find("."+$.fn.pickadate.defaults.klass.navNext).click(),t.find("."+$.fn.pickadate.defaults.klass.navNext).click(),i.setMonth(a.getMonth()+1),i=new Date(a.getFullYear(),a.getMonth()+1,a.getDate());i.getMonth()>a.getMonth()+1;)i=new Date(i.getFullYear(),i.getMonth(),i.getDate()-1);deepEqual(e.get("highlight").obj,i,"Next month: "+i),deepEqual(e.get("select"),null,"Select unaffected"),i.setDate(1),deepEqual(e.get("view").obj,i,"View updated")}),test("Today",function(){var e=this.picker;e.open(),e.$root.find("."+$.fn.pickadate.defaults.klass.buttonToday).click(),strictEqual(e.get("value"),e.get("select",$.fn.pickadate.defaults.format),"Value set to today")}),test("Clear",function(){var e=this.picker;e.open(),e.set("select",new Date),strictEqual(e.get("value"),e.get("select",$.fn.pickadate.defaults.format),"Value updated"),e.$root.find("."+$.fn.pickadate.defaults.klass.buttonClear).click(),strictEqual(e.get("value"),"","Value cleared")}),test("Closes upon selection",function(){var e=this.picker;e.open(),ok(e.get("open"),"Opened to start off"),e.$holder.find("[data-pick]").click(),ok(!e.get("open"),"Closed after selection")}),test("Closes upon clearing",function(){var e=this.picker;e.open(),ok(e.get("open"),"Opened to start off"),e.$holder.find("[data-clear]").click(),ok(!e.get("open"),"Closed after clearing")}),module("Date picker mouse events",{setup:function(){$DOM.append($INPUT.clone());var e=$DOM.find("input").pickadate({closeOnSelect:!1,closeOnClear:!1});this.picker=e.pickadate("picker")},teardown:function(){this.picker.stop(),$DOM.empty()}}),test("Remains open upon selection with option",function(){var e=this.picker;e.open(),ok(e.get("open"),"Opened to start off"),e.$holder.find("[data-pick]").click(),ok(e.get("open"),"Remains open after selection")}),test("Closes upon clearing",function(){var e=this.picker;e.open(),ok(e.get("open"),"Opened to start off"),e.$holder.find("[data-clear]").click(),ok(e.get("open"),"Remains open after clearing")}),module("Date picker keyboard events",{setup:function(){$DOM.append($INPUT.clone());var e=$DOM.find("input").pickadate();this.picker=e.pickadate("picker")},teardown:function(){this.picker.stop(),$DOM.empty()}}),test("Select",function(){var e=this.picker,t=e.$holder,a=new Date;a.setHours(0,0,0,0);for(var i=0;i<10;i+=1)e.open(),a.setDate(a.getDate()+10),e.set("highlight",a),t.trigger({type:"keydown",keyCode:13}),deepEqual(e.get("select"),e.get("highlight"),"Select updated to: "+e.get("select").obj)}),test("Highlight",function(){var e=this.picker,t=e.$holder,a=new Date;e.open();for(var i=0;i<10;i+=1)t.trigger({type:"keydown",keyCode:40}),a.setDate(a.getDate()+7),strictEqual(e.get("highlight").date,a.getDate(),'Keyed "down" to: '+e.get("highlight","yyyy/mm/dd")),strictEqual(e.get("view").month,e.get("highlight").month,'Updated "view" to: '+e.get("view","yyyy/mm/dd"));for(var d=0;d<10;d+=1)t.trigger({type:"keydown",keyCode:38}),a.setDate(a.getDate()-7),strictEqual(e.get("highlight").date,a.getDate(),'Keyed "up" to: '+e.get("highlight","yyyy/mm/dd")),strictEqual(e.get("view").month,e.get("highlight").month,'Updated "view" to: '+e.get("view","yyyy/mm/dd"));for(var l=0;l<10;l+=1)t.trigger({type:"keydown",keyCode:37}),a.setDate(a.getDate()-1),ok(e.get("highlight").date===a.getDate()&&e.get("highlight").day===a.getDay(),'Keyed "left" to: '+e.get("highlight","yyyy/mm/dd")),strictEqual(e.get("view").month,e.get("highlight").month,'Updated "view" to: '+e.get("view","yyyy/mm/dd"));for(var n=0;n<10;n+=1)t.trigger({type:"keydown",keyCode:39}),a.setDate(a.getDate()+1),ok(e.get("highlight").date===a.getDate()&&e.get("highlight").day===a.getDay(),'Keyed "right" to: '+e.get("highlight","yyyy/mm/dd")),strictEqual(e.get("view").month,e.get("highlight").month,'Updated "view" to: '+e.get("view","yyyy/mm/dd"))}),test("Closes upon selection",function(){var e=this.picker;e.open(),ok(e.get("open"),"Opened to start off"),e.$holder.find("[data-pick]").focus(),e.$holder.trigger({type:"keydown",keyCode:13}),ok(!e.get("open"),"Closed after selection")}),test("Closes upon clearing",function(){var e=this.picker;e.open(),ok(e.get("open"),"Opened to start off"),e.$holder.find("[data-clear]").focus(),e.$holder.trigger({type:"keydown",keyCode:13}),ok(!e.get("open"),"Closed after clearing")}),module("Date picker keyboard events",{setup:function(){$DOM.append($INPUT.clone());var e=$DOM.find("input").pickadate({closeOnSelect:!1,closeOnClear:!1});this.picker=e.pickadate("picker")},teardown:function(){this.picker.stop(),$DOM.empty()}}),test("Remains open upon selection with option",function(){var e=this.picker;e.open(),ok(e.get("open"),"Opened to start off"),e.$holder.find("[data-pick]").focus(),e.$holder.trigger({type:"keydown",keyCode:13}),ok(e.get("open"),"Remains open after selection")}),test("Closes upon clearing",function(){var e=this.picker;e.open(),ok(e.get("open"),"Opened to start off"),e.$holder.find("[data-clear]").focus(),e.$holder.trigger({type:"keydown",keyCode:13}),ok(e.get("open"),"Remains open after clearing")}),module("Date picker with a visible value",{setup:function(){$DOM.append($INPUT.clone().val("14 August, 1988"));var e=$DOM.find("input").pickadate();this.picker=e.pickadate("picker")},teardown:function(){this.picker.stop(),$DOM.empty()}}),test("`value` to select, highlight, and view",function(){var e=this.picker;ok(!e._hidden,"No hidden input"),deepEqual(e.get("select").obj,new Date(1988,7,14),"Selects date"),deepEqual(e.get("highlight").obj,new Date(1988,7,14),"Highlights date"),deepEqual(e.get("view").obj,new Date(1988,7,1),"Viewsets date")}),module("Date picker with a simple format",{setup:function(){$DOM.append($INPUT.clone().val("1988-08-14"));var e=$DOM.find("input").pickadate({format:"yyyy-mm-dd"});this.picker=e.pickadate("picker")},teardown:function(){this.picker.stop(),$DOM.empty()}}),test("`value` to select, highlight, and view",function(){var e=this.picker;ok(!e._hidden,"No hidden input"),deepEqual(e.get("select").obj,new Date(1988,7,14),"Selects date"),deepEqual(e.get("highlight").obj,new Date(1988,7,14),"Highlights date"),deepEqual(e.get("view").obj,new Date(1988,7,1),"Viewsets date")}),module("Date picker with a hidden value",{teardown:function(){$DOM.empty()}}),test("`value` to select, highlight, and view",function(){$DOM.append($INPUT.clone().val("14 August, 1988"));var e=$DOM.find("input").pickadate({formatSubmit:"yyyy/mm/dd"}).pickadate("picker");ok(e._hidden,"Has hidden input"),strictEqual(e._hidden.value,"1988/08/14","Hidden input value"),deepEqual(e.get("select").obj,new Date(1988,7,14),"Selects date"),deepEqual(e.get("highlight").obj,new Date(1988,7,14),"Highlights date"),deepEqual(e.get("view").obj,new Date(1988,7,1),"Viewsets date")}),test("`data-value` to select, highlight, and view",function(){$DOM.append($INPUT.clone().data("value","1988/08/14"));var e=$DOM.find("input").pickadate({formatSubmit:"yyyy/mm/dd"}).pickadate("picker");ok(e._hidden,"Has hidden input"),strictEqual(e._hidden.value,"1988/08/14","Hidden input value"),deepEqual(e.get("select").obj,new Date(1988,7,14),"Selects date"),deepEqual(e.get("highlight").obj,new Date(1988,7,14),"Highlights date"),deepEqual(e.get("view").obj,new Date(1988,7,1),"Viewsets date")}),test('the pre-filled `value` selected is no longer "active"',function(){var e=$('<input type="text" value="14 August, 2014">').pickadate({formatSubmit:"yyyy/mm/dd",min:[2015,7,14]}).pickadate("picker");strictEqual(e.get("value"),"14 August, 2014","Sets the default value"),strictEqual(e.get("valueSubmit"),"2014/08/14","Sets the default value to submit");var t=e.get("select");deepEqual([t.year,t.month,t.date],[2014,7,14],"Sets the default select")});